import{N as o,k as s,l as e,c as t,w as n,e as i,o as a,a as p,d as u,h as c,i as r,O as l}from"./index-CIWIA-pi.js";import{V as m}from"./uni-cloud.es.B_W3E-Ew.js";import{_ as d}from"./uni-id-pages-sms-form.gauMJo6N.js";import{_ as h}from"./uni-forms.M1boJhv0.js";import{_ as f}from"./uni-popup-captcha.DilczQtq.js";import{m as g}from"./login-page.mixin.Cwl58H02.js";import{_}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./uni-captcha.C7RiY6Ow.js";import"./uni-icons.FDEwJa58.js";import"./uni-easyinput.CJt8y4HP.js";import"./uni-popup.34yZ4x7L.js";import"./store.CmmNAAzQ.js";const j=_({mixins:[g],data:()=>({code:"",phone:"",captcha:"",logo:"/static/logo.png"}),computed:{tipText(){return"验证码已通过短信发送至"+this.phone}},onLoad({phoneNumber:o}){this.phone=o},onShow(){document.onkeydown=o=>{var s=o||window.event;s&&13==s.keyCode&&this.submit()}},methods:{submit(){const s=m.importObject("uni-id-co",{errorOptions:{type:"toast"}});if(6!=this.code.length)return this.$refs.smsCode.focusSmsCodeInput=!0,o({title:"验证码不能为空",icon:"none",duration:3e3});s.loginBySms({mobile:this.phone,code:this.code,captcha:this.captcha}).then((o=>{this.loginSuccess(o)})).catch((o=>{"uni-id-captcha-required"==o.errCode?this.$refs.popup.open():console.log(o.errMsg)})).finally((o=>{this.captcha=""}))}}},[["render",function(o,m,g,_,j,b){const y=c,C=i,x=r,V=s(e("uni-id-pages-sms-form"),d),w=l,k=s(e("uni-forms"),h),v=s(e("uni-popup-captcha"),f);return a(),t(C,{class:"uni-content"},{default:n((()=>[p(C,{class:"login-logo"},{default:n((()=>[p(y,{src:j.logo},null,8,["src"])])),_:1}),p(x,{class:"title"},{default:n((()=>[u("请输入验证码")])),_:1}),p(x,{class:"tip"},{default:n((()=>[u("先输入图形验证码，再获取短信验证码")])),_:1}),p(k,null,{default:n((()=>[p(V,{focusCaptchaInput:"",modelValue:j.code,"onUpdate:modelValue":m[0]||(m[0]=o=>j.code=o),type:"login-by-sms",ref:"smsCode",phone:j.phone},null,8,["modelValue","phone"]),p(w,{class:"uni-btn send-btn",type:"primary",onClick:b.submit},{default:n((()=>[u("登录")])),_:1},8,["onClick"])])),_:1}),p(v,{onConfirm:b.submit,modelValue:j.captcha,"onUpdate:modelValue":m[1]||(m[1]=o=>j.captcha=o),scene:"login-by-sms",ref:"popup"},null,8,["onConfirm","modelValue"])])),_:1})}],["__scopeId","data-v-93225fe2"]]);export{j as default};
