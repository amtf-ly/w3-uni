import{N as e,a5 as a,x as s,K as o,k as t,l as r,c as i,w as l,e as u,o as n,a as m,d,h as c,i as p,O as f}from"./index-CIWIA-pi.js";import{V as h}from"./uni-cloud.es.B_W3E-Ew.js";import{_ as g}from"./uni-match-media.B_T6meol.js";import{_}from"./uni-easyinput.CJt8y4HP.js";import{_ as w}from"./uni-forms-item.DnUp95-v.js";import{_ as b}from"./uni-captcha.C7RiY6Ow.js";import{_ as V}from"./uni-id-pages-agreements.xOL7IrPN.js";import{_ as k}from"./uni-forms.M1boJhv0.js";import{r as D}from"./validator.1P4rWcgD.js";import{m as j}from"./login-page.mixin.Cwl58H02.js";import"./store.CmmNAAzQ.js";import{_ as y}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./uni-icons.FDEwJa58.js";import"./uni-popup-dialog.etP6FnJ2.js";import"./uni-popup.34yZ4x7L.js";import"./password.DrN7_3y1.js";h.importObject("a_admin",{errorOptions:{type:"toast"}});const C=h.importObject("uni-id-co");const x=y({mixins:[j],data:()=>({formData:{username:"",nickname:"",password:"",password2:"",captcha:""},rules:D,focusUsername:!1,focus_mobile:!1,focusNickname:!1,focusPassword:!1,focusPassword2:!1,logo:"/static/logo.png"}),onReady(){this.$refs.form.setRules(this.rules)},onShow(){document.onkeydown=e=>{var a=e||window.event;a&&13==a.keyCode&&this.submit()}},methods:{submit(){this.$refs.form.validate().then((a=>4!=this.formData.captcha.length?(this.$refs.captcha.focusCaptchaInput=!0,e({title:"请输入验证码",icon:"none",duration:3e3})):this.needAgreements&&!this.agree?this.$refs.agreements.popup((()=>{this.submitForm(a)})):void this.submitForm(a))).catch((e=>{let a=e[0].key;a=a.replace(a[0],a[0].toUpperCase()),this["focus"+a]=!0}))},submitForm(e){C.registerUser(this.formData).then((e=>{this.注册成功(e),a({success:async function(e){const a=e.cid,s=await C.setPushCid({pushClientId:a});console.log("amtf^setPushCid",s)},fail(e){console.log("getPushClientId出错：",e)}})})).catch((e=>{console.log(e.message),this.$refs.captcha.getImageCaptcha()}))},navigateBack(){s()},toLogin(){o({url:"/uni_modules/uni-id-pages/pages/login/login-withpwd"})},registerByEmail(){o({url:"/uni_modules/uni-id-pages/pages/register/register-by-email"})}}},[["render",function(e,a,s,o,h,D){const j=c,y=u,C=p,x=t(r("uni-match-media"),g),B=t(r("uni-easyinput"),_),v=t(r("uni-forms-item"),w),U=t(r("uni-captcha"),b),P=t(r("uni-id-pages-agreements"),V),q=f,I=t(r("uni-forms"),k);return n(),i(y,{class:"uni-content"},{default:l((()=>[m(x,{"min-width":690},{default:l((()=>[m(y,{class:"login-logo"},{default:l((()=>[m(j,{src:h.logo},null,8,["src"])])),_:1}),m(C,{class:"title title-box"},{default:l((()=>[d("用户名密码注册")])),_:1})])),_:1}),m(I,{ref:"form",value:h.formData,rules:h.rules,"validate-trigger":"submit","err-show-type":"toast"},{default:l((()=>[m(v,{name:"username",required:""},{default:l((()=>[m(B,{inputBorder:!1,focus:h.focusUsername,onBlur:a[0]||(a[0]=e=>h.focusUsername=!1),class:"input-box",placeholder:"请输入 用户名",modelValue:h.formData.username,"onUpdate:modelValue":a[1]||(a[1]=e=>h.formData.username=e),trim:"both"},null,8,["focus","modelValue"])])),_:1}),m(v,{name:"mobile",required:""},{default:l((()=>[m(B,{inputBorder:!1,focus:h.focus_mobile,onBlur:a[2]||(a[2]=e=>h.focus_mobile=!1),class:"input-box",placeholder:"请输入 手机号",modelValue:h.formData.mobile,"onUpdate:modelValue":a[3]||(a[3]=e=>h.formData.mobile=e),trim:"both"},null,8,["focus","modelValue"])])),_:1}),m(v,{name:"password",modelValue:h.formData.password,"onUpdate:modelValue":a[6]||(a[6]=e=>h.formData.password=e),required:""},{default:l((()=>[m(B,{inputBorder:!1,focus:h.focusPassword,onBlur:a[4]||(a[4]=e=>h.focusPassword=!1),class:"input-box",maxlength:"20",placeholder:"请输入位密码",type:"password",modelValue:h.formData.password,"onUpdate:modelValue":a[5]||(a[5]=e=>h.formData.password=e),trim:"both"},null,8,["focus","modelValue"])])),_:1},8,["modelValue"]),m(v,{name:"password2",modelValue:h.formData.password2,"onUpdate:modelValue":a[9]||(a[9]=e=>h.formData.password2=e),required:""},{default:l((()=>[m(B,{inputBorder:!1,focus:h.focusPassword2,onBlur:a[7]||(a[7]=e=>h.focusPassword2=!1),class:"input-box",placeholder:"再次输入密码",maxlength:"20",type:"password",modelValue:h.formData.password2,"onUpdate:modelValue":a[8]||(a[8]=e=>h.formData.password2=e),trim:"both"},null,8,["focus","modelValue"])])),_:1},8,["modelValue"]),m(v,null,{default:l((()=>[m(U,{class:"a-fanda",ref:"captcha",scene:"register",modelValue:h.formData.captcha,"onUpdate:modelValue":a[10]||(a[10]=e=>h.formData.captcha=e)},null,8,["modelValue"])])),_:1}),m(P,{scope:"register",ref:"agreements"},null,512),m(q,{class:"uni-btn",type:"primary",onClick:D.submit},{default:l((()=>[d("注册")])),_:1},8,["onClick"]),m(q,{onClick:D.navigateBack,class:"register-back"},{default:l((()=>[d("返回")])),_:1},8,["onClick"]),m(x,{"min-width":690},{default:l((()=>[m(y,{class:"link-box"},{default:l((()=>[m(C,{class:"link",onClick:D.registerByEmail},{default:l((()=>[d("邮箱验证码注册")])),_:1},8,["onClick"]),m(C,{class:"link",onClick:D.toLogin},{default:l((()=>[d("已有账号？点此登录")])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1},8,["value","rules"])])),_:1})}],["__scopeId","data-v-75c3071d"]]);export{x as default};
